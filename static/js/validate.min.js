/*
 * validate.js 1.1
 * Copyright (c) 2020 Cheng Yang
 * http://www.dnscc.com
 */
!function(t,e){"use strict";const r=function(){this.form=null,this.msgType=1,this.msgElement=null,this.message="",this.hooks.validate=this,this.run=function(t,r){r&&(this.msgType=2,this.msgElement=e.querySelector(r)),this.form=e.querySelector(t);let n=this.form.querySelectorAll("[data-validate]");for(let t=0;t<n.length;t++)if(!this.check(n[t]))return!1;return!0}};r.prototype.check=function(t){let e=t.dataset.name,r=t.dataset.validate;if(-1===r.indexOf("required")&&""===t.value.trim())return!0;r=r.split(";");for(let n=0;n<r.length;n++){let i,u=r[n].split("|"),a=u[0].split(":");i=void 0===a[1]?this.hooks[a[0]](t):this.hooks[a[0]](t,a[1]);let l=this.getMessage(u,a,e);if(!i)return this.showMessage(l),!1}return!0},r.prototype.checkMultiple=function(t){let e=t.name,r=this.form.querySelectorAll("[name="+e+"]");for(let t=0;t<r.length;t++)if(!0===r[t].checked)return!0;return!1},r.prototype.getMessage=function(t,e,r){if(void 0===t[1]){if(void 0===n[e[0]])return n.default.replace("{f}",r);let t=n[e[0]].replace("{f}",r);return void 0!==e[1]?t.replace("{p}",e[1]):t}return t[1]},r.prototype.showMessage=function(t){1===this.msgType?Base.ui.toast(t):this.msgElement.innerText=t};const n={default:"{f}不正确",required:"请填写{f}",min:"{f}至少{p}个字符",max:"{f}最多{p}个字符",alpha:"{f}只能填写字母",alpha_number:"{f}只能填写字母和数字",alpha_dash:"{f}只能填写字母、数字和下划线",number:"{f}只能填写数字",integer:"{f}只能填写整数",decimal:"{f}只能填写小数",greater:"{f}必须大于{p}",less:"{f}必须小于{p}",in:"{f}必须是{p}中的一个",notIn:"{f}不能是{p}中的内容",username:"{f}3-18位字母、数字及下划线，不能数字开头",nickname:"{f}2-18位中英文、数字及下划线，不能数字开头",realName:"{f}只能填写2-4位中文",password:"{f}长度至少8位",idCard:"{f}格式不正确",qq:"{f}格式不正确",mobile:"{f}格式不正确",email:"{f}格式不正确",tel:"{f}格式不正确",address:"{f}格式不正确",url:"{f}只能填写有效的url地址",ip:"{f}只能填写IP地址",fileType:"{f}文件格式不正确",is_file_type:"The {f} field must contain only {f} files.",date:"{f}的日期格式不正确",datetime:"{f}的时间格式不正确"};r.prototype.hooks={validate:null,required:function(t){return"radio"===t.type||"checkbox"===t.type?this.validate.checkMultiple(t):""!==t.value.trim()},min:function(t,e){return t.value.trim().length>=e},max:function(t,e){return t.value.trim().length<=e},alpha:function(t){return/^[a-z]+$/i.test(t.value.trim())},alpha_number:function(t){return/^[a-z0-9]+$/i.test(t.value.trim())},alpha_dash:function(t){return/^[a-z0-9_\-]+$/i.test(t.value.trim())},number:function(t){return/^\-?[0-9]*\.?[0-9]+$/.test(t.value.trim())},integer:function(t){return/^\-?[0-9]+$/.test(t.value.trim())},decimal:function(t){return/^\-?[0-9]*\.+[0-9]+$/.test(t.value.trim())},greater:function(t,e){let r=t.value.trim();return!!/^\-?[0-9]*\.?[0-9]+$/.test(r)&&parseFloat(r)>parseFloat(e)},less:function(t,e){let r=t.value.trim();return!!/^\-?[0-9]*\.?[0-9]+$/.test(r)&&parseFloat(t.value)<parseFloat(e)},in:function(t,e){return-1!==e.split(",").indexOf(t.value.trim())},notIn:function(t,e){return-1===e.split(",").indexOf(t.value.trim())},username:function(t){return/^[a-zA-Z_]{1}[\w-]{2,17}$/.test(t.value.trim())},nickname:function(t){return/^[\u4e00-\u9fa5A-za-z_]{1}[\u4e00-\u9fa5\w-]{1,17}$/.test(t.value.trim())},realName:function(t){return/^[\u4e00-\u9fa5]{2,4}$/.test(t.value.trim())},password:function(t){return/^[\S]{8,}$/.test(t.value.trim())},idCard:function(t){return/^[1-9]{1}[0-9]{16}([0-9]|[xX])$/.test(t.value.trim())},qq:function(t){return/^[1-9]{1}[0-9]{5,11}$/.test(t.value.trim())},mobile:function(t){return/^1[3|4|5|6|7|8|9]\d{9}$/.test(t.value.trim())},email:function(t){return/^[0-9a-z][_.0-9a-z-]{0,31}@([0-9a-z][0-9a-z-]{0,30}[0-9a-z]\.){1,4}[a-z]{2,4}$/.test(t.value.trim())},tel:function(t){return/^[0-9]{1}[0-9\-]{10,12}$/.test(t.value.trim())},address:function(t){return/^[\u4e00-\u9fa5\w-]{5,30}$/.test(t.value.trim())},url:function(t){return/^((http|https):\/\/(\w+:{0,1}\w*@)?(\S+)|)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/.test(t.value.trim())},ip:function(t){return/^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})$/i.test(t.value.trim())},fileType:function(t,e){let r=t.value.substr(t.value.lastIndexOf(".")+1);return-1!==e.split(",").indexOf(r.toLowerCase())},date:function(t){return t.value.trim().match(/^\d{4}-\d{1,2}-\d{1,2}$/)},datetime:function(t){let e=t.value.trim();return e.match(/^\d{1,2}:\d{1,2}:\d{1,2}$/)||e.match(/^\d{4}-\d{1,2}-\d{1,2} \d{1,2}:\d{1,2}:\d{1,2}$/)}},t.Validate={init:function(t,e){return e=void 0!==e&&e,(new r).run(t,e)}}}(window,document);